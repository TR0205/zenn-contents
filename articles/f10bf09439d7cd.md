---
title: "ã€MUIã€‘useEffectã§éåŒæœŸå‡¦ç†ã‚’å®Ÿè¡Œã—TextFieldã®åˆæœŸå€¤ã‚’è¨­å®šã™ã‚‹"
emoji: "ğŸ˜º"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Material-UI", "React", "TypeScript"]
published: true
---

# æ¦‚è¦

useEffect()ã§éåŒæœŸå‡¦ç†ã‚’å®Ÿè¡Œã—ã€å–å¾—ã—ãŸå€¤ã‚’ TextField ã®åˆæœŸå€¤ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹æ©Ÿä¼šãŒã‚ã£ãŸ
å®Ÿè£…ã—ãŸè¦‹ãŸã¨ã“ã‚ã€useEffect()ã§å–å¾—ã—ãŸå€¤ãŒãƒ•ã‚©ãƒ¼ãƒ ã«è¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸã®ã§åŸå› ã¨å¯¾å‡¦æ³•ã‚’ãƒ¡ãƒ¢

![](https://storage.googleapis.com/zenn-user-upload/c2a2e732c777-20230712.png)
_å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸_

# ç’°å¢ƒ

React 18
MUI 5

# è©³ç´°

å½“åˆã®å¤±æ•—ã‚³ãƒ¼ãƒ‰ãŒä»¥ä¸‹

```tsx:NG
const [data, setData] = useState<response>({
  uri: "",
});

useEffect(() => {
  (async () => {
    const apiResponse = await apiRequest();
    setData(apiResponse);
  })();
}, []);

return (
  <>
    <TextField defaultValue={data.uri} disabled fullWidth />
  </>
);
```

ã“ã‚Œã§ã¯å–å¾—ã—ãŸå€¤ãŒãƒ•ã‚©ãƒ¼ãƒ ã«è¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸ

# åŸå› 

- useState ã§å€¤ã‚’ç®¡ç†ã™ã‚‹å ´åˆã¯**åˆ¶å¾¡**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦æ‰±ã†
- defaultValue ã¯**éåˆ¶å¾¡**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§æ‰±ã†å ´åˆã®åˆæœŸå€¤æŒ‡å®šæ–¹æ³•
- åˆ¶å¾¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦æ‰±ã†å ´åˆã¯ value ã§ OK

```tsx:OK
const [data, setData] = useState<response>({
  uri: "",
});

useEffect(() => {
  (async () => {
    const apiResponse = await apiRequest();
    setData(apiResponse);
  })();
}, []);

return (
  <>
    <TextField value={data.uri} disabled fullWidth />
  </>
);
```

defaultValue ã‚’ value ã«ã—ãŸã¨ã“ã‚æˆåŠŸã—ãŸ

# å‚è€ƒ

https://zenn.dev/longbridge/articles/640710005e11b1

> controlled componentï¼ˆåˆ¶å¾¡ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰ã¯ã€å…¥åŠ›å€¤ãªã©ã‚’ state ã§ç®¡ç†ã™ã‚‹ã‚ˆã†ã«ã‚ˆã†ã«åˆ¶å¾¡ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚
> Controlled component ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚
> React.useState ã§ input è¦ç´ ã®å…¥åŠ›å€¤ã‚’ç®¡ç†ã—ã¾ã™ã€‚

https://stackoverflow.com/questions/69294847/issue-in-textfield-default-value-set-using-the-useeffect-hook-in-the-material-ui

> you don't need to update its default value in useEffect(). and use value instead of defaultValue, just do it like this:

```tsx
const Editform = () => {
  const [uname, setname] = useState("Jubed Alam");
  return (
    <form>
      <TextField
        margin="normal"
        label="Name"
        fullWidth
        name="name"
        value={uname}
        onChange={(e) => setname(e.target.value)}
      />
      <Button variant="contained" color="primary" type="submit">
        Submit
      </Button>
    </form>
  );
};
```
